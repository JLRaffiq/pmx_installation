version: '3.8'

services:
  nginx:
    image: nginx:alpine
    container_name: pmx-nginx
    ports:
      - "8080:80"
    volumes:
      - ./:/usr/share/nginx/html:ro
    restart: unless-stopped
    command: >
      sh -c "
      echo 'server {
          listen 80;
          server_name localhost;
          root /usr/share/nginx/html;
          
          location ~ \.sh$ {
              add_header Content-Type text/plain;
              add_header Access-Control-Allow-Origin *;
          }
          
          location / {
              autoindex on;
              autoindex_exact_size off;
              autoindex_localtime on;
          }
      }' > /etc/nginx/conf.d/default.conf &&
      nginx -g 'daemon off;'
      "
